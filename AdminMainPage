
package myupepeoproject;

import java.awt.Color;
import java.awt.Component;
import javax.swing.JFrame;
import javax.swing.JTextField;
import javax.swing.JLabel;
import javax.swing.JButton;
import javax.swing.JPanel;



import java.awt.event.*;
import javax.swing.JOptionPane;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.PreparedStatement;
import java.sql.Statement;
import java.sql.SQLException;
import java.sql.Connection;
import java.util.Date;
import javax.swing.JComboBox;
import javax.swing.JDesktopPane;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JPasswordField;
import javax.swing.JScrollPane;
import javax.swing.JTabbedPane;
import javax.swing.JTable;
//S     T       A       R       T      O      F       C       L       A       S       S

public class Returns extends JFrame{
    //menu
     private static JMenuBar menubar;
              private static JMenu file;
              private static JMenuItem borrowers,returns,income,catalogue,members,exit;
    
    //end of menu
    
    
     //RETURN DETAILS
    Connection Conn=null;
    ResultSet Results=null;
    PreparedStatement pstm=null;
     private com.toedter.calendar.JDateChooser ReturnborrowersjDateChooser,ReturnduedatejDateChooser,ReturndateofreturnjDateChooser;
       private static JTextField searchVideos,searchMembers,mID,fName, middlename,lName,vcode,vlabel,vcategory,vcondition,overdueDays,fine,lostPayment;
private static JLabel message,searchvLabel,searchMLabel,mIdLabel,fl,mL, ll ,vcdeLabel,label,categoryLabel ,vconditionL,borrowingdateLabel,duedateLabel,dateofReturnL,overdueDaysL,fineL,lostPaymentL;
private static JButton save,reset, cancel;
private static JPanel navigationPanel; 
private static JDesktopPane pane;
//Server
private static String Servercode,Serverlabel,Servercategory,Servermid,Serverfirstname,Servermiddlename,Serverlastname,Serverborrowingdate,Serverduedate;
 //BOWWERS DETAILS
Connection sqlConnection=null;
PreparedStatement pst=null;
PreparedStatement pst2=null;
ResultSet queryResults=null;
 private com.toedter.calendar.JDateChooser BorrowersjDateChooser;
  private com.toedter.calendar.JDateChooser BorrowersDueDatejDateChooser;
private static JTextField searchVideo,searchMember,mIDb,fNameb, middlenameb,lNameb,vcodeb,vlabelb,vcategoryb,vCategorypaymentb;
private static JLabel Borrowersmessage,searchvLabelb,searchMLabelb,mIdLabelb,flb,mLb, llb ,vcdeLabelb,labelb,categoryLabelb ,vcpaymentLabelb,borrowingdateLabelb,duedateLabelb;
private static JButton saveb,resetb, cancelb;
private static String firstname,middleName,lastname,svcode,slabel,scategory,svPAYMENT;
private static JDesktopPane borrowersPane;

//VideoCATALOGUE
 private com.toedter.calendar.JDateChooser CataloguejDateChooser;
private static JMenuBar mainMenu;

private static JTextField vid, vL,date;
private static JComboBox vCat,vAvail;
private static JButton addV,newV,cancelE;
private JLabel l1,vidl,vcl,vl,va,ed;
 
private static JDesktopPane cataloguePane;

//PANELS
private static JPanel topPanel,CenterPanel,bottomPanel,sidePanel,inPanel;

//Reports section

private static JTable reportBorrowersTable,ReturnReportTable,catalogueTable,memebrTable;
private static JTabbedPane reportLayoutPane,reportLayoutPaneR;
private static JPanel panelBorrowersReport,panelReturnReport,panelCatalogueReport,panelMemberReport;
private static JScrollPane BorrowersReportSP,ReturnReportSP,CatalogueSP;

public Returns(){
      super("UPEPEO CLUB VIDEO LENDING SECTION-ADMINISTRATOR'S PAGE");
    setLayout(null);
    setSize(1300,750);
    setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
    setVisible(true);
    
 
   
   menubar=new  JMenuBar();
   menubar.setBackground(Color.BLUE);
   menubar.setBounds(0,0,600,15);
   setJMenuBar(menubar);
   
   file=new JMenu("FILE");
   file.setForeground(Color.WHITE);
   menubar.add(file);
   
   borrowers=new JMenuItem("1: Video Borrowing Section");
    borrowers.setForeground(Color.RED);
    file.add( borrowers);
    
    returns=new JMenuItem("2: Video Returned Section");
    returns.setForeground(Color.RED);
    file.add(returns);
    
    catalogue=new JMenuItem("3: Catlogue");
    catalogue.setForeground(Color.RED);
    file.add(catalogue);
    
    members=new JMenuItem("4: Members Report");
     members.setForeground(Color.RED);
      file.add( members);
      
      income=new JMenuItem("5: IncomeAllocation section");
      income.setForeground(Color.RED);
      file.add(income);
      
      exit=new JMenuItem("6: EXIT");
      exit.setForeground(Color.BLACK);
      file.add(exit);
      //End of My Menu Bar
   //CenterPanel   
   CenterPanel=new JPanel();
   CenterPanel.setBounds(600,15,50,530);
   CenterPanel.setBackground(Color.BLACK);
   add(CenterPanel);
   
   //inPanel
   inPanel=new JPanel();
   inPanel.setBackground(Color.BLACK);
   inPanel.setBounds(0,375,600,10);
   add(inPanel);
   
   //bottomPanel
   
   bottomPanel=new JPanel();
   bottomPanel.setBackground(Color.RED);
   bottomPanel.setBounds(0,545,1280,16);
   add(bottomPanel);
    //JDesktopPane
    pane=new JDesktopPane();
    pane.setBackground(Color.GREEN);
    pane.setBounds(650,15,630,530);
    pane.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Returned Videos Details", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Times New Roman", 1, 14), new java.awt.Color(255,0,0)));
    pane.setFont(new java.awt.Font("Times New Roman", 1, 24));
    add(pane);//End of pane
    
    searchMLabel=new JLabel("Search Member by MemberID:");
    searchMLabel.setBounds(50,35,175,20);
    searchMLabel.setForeground(Color.BLUE);
    pane.add(searchMLabel);
    
    searchMembers=new JTextField();
    searchMembers.setBounds(250,35,200,20);
    searchMembers.setBackground(Color.PINK);
    pane.add(searchMembers);
    
    mIdLabel=new JLabel("MemberID:");
    mIdLabel.setBounds(10,70,90,20);
    pane.add(mIdLabel);
    
    mID=new JTextField();
    mID.setBounds(85,70,200,20);
      pane.add(mID);
    
    fl=new JLabel("FirstName:");
fl.setBounds(10,110, 100, 20);
pane.add(fl);
fName=new JTextField();
fName.setBounds(85, 110, 200, 20);
pane.add(fName);

ll=new JLabel("LastName:");
ll.setBounds(10,150, 100, 20);
pane.add(ll);
lName=new JTextField();
lName.setBounds(85, 150, 200, 20);
pane.add(lName);

mL=new JLabel("MiddleName:");
mL.setBounds(10,190, 100, 20);
pane.add(mL);
middlename=new JTextField();
middlename.setBounds(85, 190, 200, 20);
pane.add(middlename);



vcdeLabel=new JLabel("VideoCode:");
  vcdeLabel.setBounds(310,70,90,20);
 pane. add(vcdeLabel);
  
  vcode=new JTextField();
   vcode.setBounds(400,70,200,20);
          pane. add( vcode);
    
           label=new JLabel("VideoLabel:");
           label.setBounds(310,110,90,20);
           pane.add(label);
           
           vlabel=new JTextField();
           vlabel.setBounds(400,110,200,20);
           pane.add(vlabel);
           
           
           categoryLabel=new JLabel("VideoCategory:");
           categoryLabel.setBounds(290,150,100,20);
           pane.add(categoryLabel);
           
           vcategory=new JTextField();
           vcategory.setBounds(400,150,200,20);
           pane.add(vcategory);
           
           vconditionL=new JLabel("Condition:");
           vconditionL.setBounds(310,190,90,20);
           pane.add( vconditionL);
           
            vcondition=new JTextField();
            vcondition.setBounds(400,190,200,20);
          pane. add( vcondition);
           
           borrowingdateLabel=new JLabel("Borrowing Date:");
           borrowingdateLabel.setBounds(160,230,100,20);
           pane.add(borrowingdateLabel);
           
           ReturnborrowersjDateChooser=new com.toedter.calendar.JDateChooser();
          ReturnborrowersjDateChooser.setBounds(270,230,200,20);
          ReturnborrowersjDateChooser.setDateFormatString("yyy/MM/dd");
          pane. add(ReturnborrowersjDateChooser);
           
           duedateLabel=new JLabel("DueDate:");
            duedateLabel.setBounds(190,270,90,20);
           pane. add( duedateLabel);
            
             ReturnduedatejDateChooser=new com.toedter.calendar.JDateChooser();
               ReturnduedatejDateChooser.setBounds(270,270,200,20);
                 ReturnduedatejDateChooser.setDateFormatString("yyy/MM/dd");
              pane. add(  ReturnduedatejDateChooser);
               
               dateofReturnL=new JLabel("Return Date:");
               dateofReturnL.setBounds(170,310,100,20);
               pane.add(dateofReturnL);
               
               ReturndateofreturnjDateChooser=new com.toedter.calendar.JDateChooser();
              ReturndateofreturnjDateChooser.setBounds(270,310,200,20);
              ReturndateofreturnjDateChooser.setDateFormatString("yyy/MM/dd");
               pane.add( ReturndateofreturnjDateChooser);
               
               overdueDaysL=new JLabel("OverDueDays:");
               overdueDaysL.setBounds(170,350,100,20);
               pane.add(overdueDaysL);
               
               overdueDays=new JTextField();
               overdueDays.setBounds(270,350,200,20);
               pane.add(overdueDays);
               
               fineL=new JLabel("Fine:");
               fineL.setBounds(210,390,100,20);
               pane.add(fineL);
               
               fine=new JTextField();
               fine.setBounds(270,390,200,20);
               pane.add(fine);
               
               lostPaymentL=new JLabel("LostPayment:");
               lostPaymentL.setBounds(170,430,100,20);
              pane. add(lostPaymentL);
               
               lostPayment=new JTextField();
               lostPayment.setBounds(270,430,200,20);
              pane. add(lostPayment);
           
           // Returns buttons
           
           save=new JButton("SAVE");
           save.setBounds(110,490,90,40);
           save.setBackground(Color.ORANGE);
           save.setForeground(Color.BLUE);
          pane.add(save);
           
            reset=new JButton("RESET");
           reset.setBounds(280,490,90,40);
           reset.setBackground(Color.ORANGE);
           reset.setForeground(Color.BLUE);
          pane.add(reset);
           
            cancel=new JButton("CANCEL");
          cancel.setBounds(450,490,90,40);
           cancel.setBackground(Color.ORANGE);
           cancel.setForeground(Color.BLUE);
         pane.add(cancel);
         
         //tabedpane reportLayoutPane

reportLayoutPane=new JTabbedPane();
reportLayoutPane.setBackground(Color.BLACK);
reportLayoutPane.setForeground(Color.BLUE);
reportLayoutPane.setBounds(10,560,1250,150);
add(reportLayoutPane);

ReturnReportTable=new JTable();
ReturnReportTable.setBounds(0,570,1240,140);
ReturnReportTable.setBackground(Color.ORANGE);
ReturnReportTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null,null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null, null, null, null,null}
            },
            new String [] {
                "MemberID", "FirstName","middleName", "lastName","VideoCode","VideoCategory","VideoLabel","Borrowing_Date","DueDate","Return_Date","Overdue_Days","Fine","LostPayment"
            }
        ));
ReturnReportSP=new JScrollPane();

    panelReturnReport=new JPanel();
    panelReturnReport.setBackground(Color.WHITE);
   
    panelReturnReport.add(ReturnReportSP);

//table
   ReturnReportSP.setViewportView(ReturnReportTable);


reportLayoutPane.addTab("RETURNED_VIDEO_REPORT",ReturnReportSP);


//e     v       e      n       t       s

ReturnSaveButtonEvent sbe=new ReturnSaveButtonEvent();
save.addActionListener(sbe);

ReturnsearchMembersEvent rsme=new ReturnsearchMembersEvent();
searchMembers.addActionListener(rsme);

ReturnResetButtonEvent rbe=new ReturnResetButtonEvent();
reset.addActionListener(rbe);

ReturnCancelButtonEvent cbe=new ReturnCancelButtonEvent();
cancel.addActionListener(cbe);

         
         // E       N       D       OF                  R       E       T       U       R       N       S
         
//BORROWERS INFORMATION
        
         
         borrowersPane= new JDesktopPane();
         borrowersPane.setBackground(Color.GREEN);
         borrowersPane.setBounds(0,15,600,360);
         borrowersPane.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Borrowers Details", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Times New Roman", 1, 14), new java.awt.Color(255,0,0)));
          borrowersPane.setFont(new java.awt.Font("Times New Roman", 1, 24));
         add(borrowersPane);
         
         // Borrowers Body
         
         searchMLabelb=new JLabel("Search Member by MemberID:");
searchMLabelb.setBounds(1,20,175,20);
   searchMLabelb.setForeground(Color.BLUE);
    borrowersPane.add(searchMLabelb);
    
    searchMember=new JTextField();
    searchMember.setBounds(176,20,100,20);
    borrowersPane.add(searchMember);
    
    mIdLabelb=new JLabel("MemberID:");
    mIdLabelb.setBounds(1,50,90,20);
    borrowersPane.add(mIdLabelb);
    
    mIDb=new JTextField();
    mIDb.setBounds(75,50,200,20);
         borrowersPane.add(mIDb);
    
    flb=new JLabel("FirstName:");
flb.setBounds(1,90, 100, 20);
borrowersPane.add(flb);
fNameb=new JTextField();
fNameb.setBounds(75, 90, 200, 20);
borrowersPane.add(fNameb);

mLb=new JLabel("MiddleName:");
mLb.setBounds(1,130, 100, 20);
borrowersPane.add(mLb);
middlenameb=new JTextField();
middlenameb.setBounds(75, 170, 200, 20);
borrowersPane.add(middlenameb);

llb=new JLabel("LastName:");
llb.setBounds(1,170, 100, 20);
borrowersPane.add(llb);
lNameb=new JTextField();
lNameb.setBounds(75, 130, 200, 20);
borrowersPane.add(lNameb);



searchvLabelb=new JLabel("Search Video by VideoCode:");
searchvLabelb.setBounds(300,20,200,20);
searchvLabelb.setForeground(Color.BLUE);
borrowersPane.add(searchvLabelb);

searchVideo=new JTextField();
searchVideo.setBounds(470,20,120,20);
borrowersPane.add(searchVideo);

vcdeLabelb=new JLabel("VideoCode:");
  vcdeLabelb.setBounds(300,50,90,20);
  borrowersPane.add(vcdeLabelb);
  
  vcodeb=new JTextField();
   vcodeb.setBounds(390,50,200,20);
           borrowersPane.add( vcodeb);
    
           labelb=new JLabel("VideoLabel:");
           labelb.setBounds(300,90,90,20);
           borrowersPane.add(labelb);
           
           vlabelb=new JTextField();
           vlabelb.setBounds(390,90,200,20);
           borrowersPane.add(vlabelb);
           
           
           categoryLabelb=new JLabel("VideoCategory:");
           categoryLabelb.setBounds(280,130,100,20);
           borrowersPane.add(categoryLabelb);
           
           vcategoryb=new JTextField();
           vcategoryb.setBounds(390,130,200,20);
          borrowersPane. add(vcategoryb);
           
           vcpaymentLabelb=new JLabel("Payments:");
           vcpaymentLabelb.setBounds(300,170,90,20);
          borrowersPane. add(vcpaymentLabelb);
           
           vCategorypaymentb=new JTextField();
           vCategorypaymentb.setBounds(390,170,200,20);
           borrowersPane.add(vCategorypaymentb);
           
           borrowingdateLabelb=new JLabel("Borrowing Date:");
           borrowingdateLabelb.setBounds(190,210,100,20);
           borrowersPane.add(borrowingdateLabelb);
           
           BorrowersjDateChooser=new com.toedter.calendar.JDateChooser();
         BorrowersjDateChooser.setBounds(300,210,200,20);
           BorrowersjDateChooser.setDateFormatString("yyy/MM/dd");
          borrowersPane. add(BorrowersjDateChooser);
           
           duedateLabelb=new JLabel("DueDate:");
            duedateLabelb.setBounds(220,250,90,20);
           borrowersPane. add( duedateLabelb);
            
             BorrowersDueDatejDateChooser=new com.toedter.calendar.JDateChooser();
               BorrowersDueDatejDateChooser.setBounds(300,250,200,20);
               BorrowersDueDatejDateChooser.setDateFormatString("yyy/MM/dd");
              borrowersPane. add(  BorrowersDueDatejDateChooser);
           
           //buttons
           
           saveb=new JButton("SAVE");
           saveb.setBounds(70,310,90,40);
           saveb.setBackground(Color.ORANGE);
           saveb.setForeground(Color.BLUE);
           borrowersPane.add(saveb);
           
            resetb=new JButton("RESET");
           resetb.setBounds(250,310,90,40);
           resetb.setBackground(Color.ORANGE);
           resetb.setForeground(Color.BLUE);
           borrowersPane.add(resetb);
           
            cancelb=new JButton("CANCEL");
          cancelb.setBounds(420,310,90,40);
           cancelb.setBackground(Color.ORANGE);
           cancelb.setForeground(Color.BLUE);
          borrowersPane. add(cancelb);
          //tabedpane reportLayoutPane



reportBorrowersTable=new JTable();
reportBorrowersTable.setBounds(0,570,1240,140);
reportBorrowersTable.setBackground(Color.ORANGE);
reportBorrowersTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null},
                {null, null, null, null,null, null, null, null,null}
            },
            new String [] {
                "MemberID", "FirstName","middleName", "lastName","VideoCode","VideoCategory","VideoLabel","Borrowing_Date","DueDate"
            }
        ));
BorrowersReportSP=new JScrollPane();

//End of table
   BorrowersReportSP.setViewportView(reportBorrowersTable);
//panelBorrowersReport

panelBorrowersReport=new JPanel();
panelBorrowersReport.setBackground(Color.GRAY);
panelBorrowersReport.add(BorrowersReportSP);

reportLayoutPane.addTab("BORROWERS_REPORT",BorrowersReportSP);

// B    O   R   R   O   W   E   R   S       E   V   E   N   T   S

saveButtonEvent e=new saveButtonEvent();
saveb.addActionListener(e);

searchMemberEvent sme=new searchMemberEvent();
searchMember.addActionListener(sme);

searchVideoEvent sve=new searchVideoEvent();
searchVideo.addActionListener(sve);

resetEvent re=new resetEvent();
resetb.addActionListener(re);

cancelButtonEvent cbe2=new cancelButtonEvent();
cancelb.addActionListener(cbe2);


// E    N   D                  OF                        B       O       R       R   O       W       E       R       S

           
 //S        T       A       R      T       OF      C    a   t   a   l   o   g   u   e   P   a   n   e
           cataloguePane=new JDesktopPane();
           cataloguePane.setBackground(Color.GREEN);
           cataloguePane.setBounds(0,385,600,160);
           cataloguePane.setFont(new java.awt.Font("Times New Roman", 1, 24));
                   cataloguePane.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Video Catalogue", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Times New Roman", 1, 14), new java.awt.Color(255,0,0)));
           add(cataloguePane);
           //videoCatalogue Body
           //VideoIdLabel(vidl)
vidl=new JLabel("Video ID:");
vidl.setBounds(5, 20,60,20);
cataloguePane.add(vidl);//end of vidl
//VideoId (vid)
vid=new JTextField();
vid.setBounds(100,20,100,20);
cataloguePane.add(vid);// End of my Video id section
//videCategoryLabel
vcl=new JLabel("VideoCategory:");
vcl.setBounds(5, 80, 90,20);
cataloguePane.add(vcl);

vCat=new JComboBox();
vCat.setBounds(100,80,100,20);
vCat.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Category","Horror", "Catoon", "Thriller","General" }));
cataloguePane.add(vCat);

//end of vCat
//VIdeoLabel
vl=new JLabel("Video Label:");
vl.setBounds(230, 20,80, 20);
cataloguePane.add(vl);
//videoLabel;
vL=new JTextField();
vL.setBounds(300, 20, 100, 20);
cataloguePane.add(vL);//end of VideoLabel

//videAvailLabel
va=new JLabel("Availability:");
va.setBounds(230, 80, 80, 20);
cataloguePane.add(va);
//videoAvailability
vAvail=new JComboBox();
vAvail.setBounds(300, 80, 100, 20);
vAvail.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Availability","Available", "Missing" }));
cataloguePane.add(vAvail);//end of VideoAvailability

//Entry date ed
ed=new JLabel("Entry Date:");
ed.setBounds(400, 50, 80, 20);
cataloguePane.add(ed);//end of Entry Date
//Date TextField
CataloguejDateChooser=new com.toedter.calendar.JDateChooser();
CataloguejDateChooser.setBounds(490, 50, 100, 20);
cataloguePane.add(CataloguejDateChooser);//End of date TextField
//Addition of Buttons.
//Add Button
addV=new JButton("ADD");
addV.setBounds(70, 120, 90, 30);
addV.setBackground(Color.ORANGE);
addV.setForeground(Color.BLUE);
cataloguePane.add(addV);//end of add button
//New Video Button
newV=new JButton("NEXT");
newV.setBounds(250, 120, 90, 30);
newV.setBackground(Color.ORANGE);
newV.setForeground(Color.BLUE);
cataloguePane.add(newV);//end of new button
//Cancel Button
cancel=new JButton("CANCEL");
cancel.setBounds(420, 120, 90, 30);
cancel.setBackground(Color.ORANGE);
cancel.setForeground(Color.BLUE);
cataloguePane.add( cancel);//End of cancel button

// BUTTONS EVENTS
//add Button
aEvent ae=new aEvent();
addV.addActionListener(ae);
//Cancel Button
cEvent ce=new cEvent();
cancel.addActionListener(ce);
// Next button
nEvent ne=new nEvent();
newV.addActionListener(ne);            


catalogueTable=new JTable();
catalogueTable.setBounds(0,570,1240,140);
catalogueTable.setBackground(Color.ORANGE);
catalogueTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "VideoCode","VideoCategory","VideoLabel","ENTRY_Date"
            }
        ));
CatalogueSP=new JScrollPane();

//End of table
  CatalogueSP.setViewportView(catalogueTable);
//panelBorrowersReport

panelCatalogueReport=new JPanel();
panelCatalogueReport.add(CatalogueSP);

reportLayoutPane.addTab("CATALOGUE_REPORT",CatalogueSP);

//MENU EVENTS

menuitemborrowersEvent mibe=new menuitemborrowersEvent();
borrowers.addActionListener(mibe);

menuitemreturnssEvent mire=new menuitemreturnssEvent();
returns.addActionListener(mire);

menuitemCataloguesEvent mice=new menuitemCataloguesEvent();
catalogue.addActionListener(mice);

menuitemIncomeEvent mime=new menuitemIncomeEvent();
income.addActionListener(mime);

menuiteExitsEvent miee=new menuiteExitsEvent();
exit.addActionListener(miee);

//W         i           n           d           o           w                       c           l           o           s           i           n           g                   e           v           e           n           t


 addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosing(java.awt.event.WindowEvent evt) {
                formWindowClosing(evt);
            }
        });

}//END OF CONSTRUCTOR RETURN
 private void formWindowClosing(java.awt.event.WindowEvent evt) {                                   
     int form=JOptionPane.showConfirmDialog(null, "Are you sure that you really want to exit ?","CONFIRM WINDOW CLOSURE",JOptionPane.YES_NO_OPTION);
     if(form==JOptionPane.YES_OPTION){
          try{
Connection sqlConnection = DriverManager.getConnection("jdbc:mysql://localhost:3306/upepeoproject", "root", "");
//create a connection to the database
Statement sqlStatements = sqlConnection.createStatement();
String SELECT_QUERY = "SELECT userName FROM adminauthenitication";
ResultSet queryResults = sqlStatements.executeQuery(SELECT_QUERY);

while(queryResults.next()){
String adminUsername=queryResults.getString("userName");

 JOptionPane.showMessageDialog(null, " Goodbye... "+adminUsername,"CONFIRM",JOptionPane.PLAIN_MESSAGE);
 
System.exit(0);

}//End of while
}catch(SQLException e){
JOptionPane.showMessageDialog(null,"SERVER SAYS:"+ e.getMessage());
}
     }else{
         JOptionPane.showMessageDialog(null, "Thanks for Staying","CONFIRMED",JOptionPane.PLAIN_MESSAGE);
     }
    }   

//M         E           N           U       S                   E           V           E       N       T
public class menuitemCataloguesEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
        javax.swing.SwingUtilities.invokeLater(
        
        new Runnable (){
        @ Override
        public void run(){
            new VideoCatalogue();
        }
    }
        );
        
    }
}

public class menuitemreturnssEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
        
    }
}

public class menuitemIncomeEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
          javax.swing.SwingUtilities.invokeLater(
        
        new Runnable (){
        @ Override
        public void run(){
            new IncomeAllocation();
        }
    }
        );
    }
}

public class menuiteExitsEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
        int q=JOptionPane.showConfirmDialog(null, "Sure to Exit ?","Confirm",JOptionPane.YES_NO_OPTION);
        if(q==JOptionPane.YES_OPTION){
            System.exit(0);
        }else{
            
        }
    }
}

public class menuitemborrowersEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
        javax.swing.SwingUtilities.invokeLater(
        
        new Runnable (){
        @ Override
        public void run(){
            new Borrowers();
        }
    }
        );
    }
}


//R     E       T      U       R       N           E       V       E       N       T       S
 
public class ReturnCancelButtonEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
       
       int c=JOptionPane.showConfirmDialog(null, "ARE YOU SURE YOU WANT TO QUIT ?","CONFIRM",JOptionPane.YES_NO_OPTION);
       if (c==JOptionPane.YES_OPTION){
           int c2=JOptionPane.showConfirmDialog(null, "DO YOU WISH TO PERFORM OTHER OPERATIONS ?","CONFIRM",JOptionPane.YES_NO_OPTION);
           if(c2==JOptionPane.YES_OPTION){
               
           }else{
               try{
Connection sqlConnection = DriverManager.getConnection("jdbc:mysql://localhost:3306/upepeoproject", "root", "");
//create a connection to the database
Statement sqlStatements = sqlConnection.createStatement();
String SELECT_QUERY = "SELECT userName FROM adminauthenitication";
ResultSet queryResults = sqlStatements.executeQuery(SELECT_QUERY);

while(queryResults.next()){
String adminUsername=queryResults.getString("userName");

 JOptionPane.showMessageDialog(null, " Goodbye... "+adminUsername,"CONFIRM",JOptionPane.PLAIN_MESSAGE);
 
System.exit(0);

}//End of while
}catch(SQLException e){
JOptionPane.showMessageDialog(null,"SERVER SAYS:"+ e.getMessage());
}
              
           }
       }
    }
}

public class ReturnResetButtonEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
        String mymid1=mID.getText();
          String myfname1=fName.getText();
           String mymname1=middlename.getText();
            String mylname1=lName.getText();
             String code1=vcode.getText();
              String myvl1=vlabel.getText();
                String myvcat1=vcategory.getText();
               String  condition1=vcondition.getText();
                 String myborowingdate1= ((JTextField) ReturnborrowersjDateChooser.getDateEditor().getUiComponent()).getText();
                 String  myduedate1= ((JTextField) ReturnduedatejDateChooser.getDateEditor().getUiComponent()).getText();
                  String myoverduedays1=overdueDays.getText();
                   String myreturndate1= ((JTextField) ReturndateofreturnjDateChooser.getDateEditor().getUiComponent()).getText();
                    String myfine1=fine.getText();
                     String mylostpayments1=lostPayment.getText();
        if(mymid1.isEmpty()&& myfname1.isEmpty()&& mymname1.isEmpty()&& mylname1.isEmpty()&& code1.isEmpty()&& myvl1.isEmpty()&& myvcat1.isEmpty()&& condition1.isEmpty()&& myborowingdate1.isEmpty()&& myduedate1.isEmpty()&& myreturndate1.isEmpty()&& myoverduedays1.isEmpty()&& myfine1.isEmpty()&& mylostpayments1.isEmpty()){
            JOptionPane.showMessageDialog(null, "YOU CAN'T RESET AN EMPTY SET !!","ERROR",JOptionPane.ERROR_MESSAGE);
        }else{
        vcode.setText(null);
    vlabel.setText(null);
    vcategory.setText(null);
    vcondition.setText(null);
    searchMembers.setText(null);
    mID.setText(null);
    fName.setText(null);
    middlename.setText(null);
    lName.setText(null);
    ReturnborrowersjDateChooser.setDate(null);
     ReturnduedatejDateChooser.setDate(null);  
     ReturndateofreturnjDateChooser.setDate(null);
    overdueDays.setText(null);
    fine.setText(null);
    lostPayment.setText(null);
         }
    }    
}// END OF RETURN RESET BUTTON EVENT

public class ReturnsearchMembersEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
          try{
           Conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/upepeoproject", "root", "");
//create a connection to the database
Statement sqlStatements = Conn.createStatement();

pstm=Conn.prepareStatement("SELECT * FROM borrowerstable where mID= ? ");

pstm.setString(1,searchMembers.getText());
Results=pstm.executeQuery();

if(Results.next()){
    
    //pre-created variables for holding data already in the database.
   
    Servercode=Results.getString("vcode");
    Serverlabel=Results.getString("vlabel");
    Servercategory=Results.getString("vcategory");
    Servermid=Results.getString("mID");
    Serverfirstname=Results.getString("firstname");
            Servermiddlename=Results.getString("middlename");
            Serverlastname=Results.getString("lastname");                   
                   
                   
                    
                    //Callng the data already in the database and assigning it to the variables above
    vcode.setText( Servercode);
    vlabel.setText(Serverlabel);
    vcategory.setText(Servercategory);
    mID.setText(Servermid);
    fName.setText(Serverfirstname);
    middlename.setText(Servermiddlename);
    lName.setText(Serverlastname);
      ReturnborrowersjDateChooser.setDate(Results.getDate("date_of_borrowing"));      
     ReturnduedatejDateChooser.setDate(Results.getDate("duedate"));        //end of the call
    

}else{
    JOptionPane.showMessageDialog(null, "The Member ID didn't match any record in our database \n It is most possible that your account does not exist or \n you have no video in your possesion");
vcode.setText(null);
    vlabel.setText(null);
    vcategory.setText(null);
    mID.setText(null);
    fName.setText(null);
    middlename.setText(null);
    lName.setText(null);
    BorrowersjDateChooser.setDate(null);
    BorrowersDueDatejDateChooser.setDate(null);  
}

        }catch(SQLException e){
            JOptionPane.showMessageDialog(null, "SERVER SAYS: "+e.getMessage(),"SERVER MESSAGE",JOptionPane.ERROR_MESSAGE);
        }
    }
}

public class ReturnSaveButtonEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
        String mymid,myfname,mymname,mylname,code,myvl,myvcat,condition,myborowingdate,myduedate,myreturndate,myoverduedays,myfine,mylostpayments;
        mymid=mID.getText();
         myfname=fName.getText();
          mymname=middlename.getText();
           mylname=lName.getText();
            code=vcode.getText();
             myvl=vlabel.getText();
              myvcat=vcategory.getText();
               condition=vcondition.getText();
                myborowingdate=((JTextField)ReturnborrowersjDateChooser.getDateEditor().getUiComponent()).getText();
                 myduedate=((JTextField)ReturnduedatejDateChooser.getDateEditor().getUiComponent()).getText();
                 myoverduedays=overdueDays.getText();
                  myreturndate= ((JTextField)ReturndateofreturnjDateChooser.getDateEditor().getUiComponent()).getText();
                   myfine=fine.getText();
                    mylostpayments=lostPayment.getText();
                    
                    if(mymid.isEmpty()||myfname.isEmpty()||mymname.isEmpty()||mylname.isEmpty()||code.isEmpty()||myvl.isEmpty()||myvcat.isEmpty()||condition.isEmpty()|| myborowingdate.toString().isEmpty()||myduedate.toString().isEmpty()||myreturndate.toString().isEmpty()||myoverduedays.isEmpty()||myfine.isEmpty()||mylostpayments.isEmpty()){
                        JOptionPane.showMessageDialog(null, "ALL FIELDS ARE MADATORY !","ERROR MESSAGE",JOptionPane.ERROR_MESSAGE);
                    }else{
                         try{
            Connection sqlConnections = DriverManager.getConnection("jdbc:mysql://localhost:3306/upepeoproject", "root", "");
//create a connection to the database
Statement sqlStatements = sqlConnections.createStatement();
String DeleteR_QUERY="DELETE FROM retuntable WHERE vcode='"+vcode.getText()+"'";
String INSERT_QUERY = "INSERT INTO retuntable VALUES('" + code + "','" + myvl + "','" + myvcat + "','"+mymid+"','"+myfname+"','"+mymname+"','"+mylname+"','"+myborowingdate+"','"+myduedate+"','"+myreturndate+"','"+myoverduedays+"','"+myfine+"','"+mylostpayments+"','"+condition+"');";

String UPDATE_QUERY="UPDATE invetory SET availability='AVAILABLE' WHERE vcode='"+vcode.getText()+"'";

String DeleteB_QUERY="DELETE FROM borrowerstable WHERE mID='"+mID.getText()+"'";

sqlStatements.execute(DeleteR_QUERY);

sqlStatements.execute(INSERT_QUERY);

sqlStatements.execute(UPDATE_QUERY);

sqlStatements.execute(DeleteB_QUERY);

JOptionPane.showMessageDialog(null,myfname+" : "+"Your records were saved successfully and Updates done successfully","SUCCESSFUL RECORD ENTRY",JOptionPane.INFORMATION_MESSAGE);
            
        }catch(SQLException e){
            JOptionPane.showMessageDialog(null,"SERVER SAYS: "+e.getMessage(),"ERROR",JOptionPane.ERROR_MESSAGE);
        }
                    }
    }
}//E        N       D       O       F               R       E       T       U       R       N           E       V       E       N       T       S
//S     T           A       R       T                         B        O   R       RO  W   ER  S       E   VE  N   T   S  


public class searchVideoEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
       
        try{
           sqlConnection = DriverManager.getConnection("jdbc:mysql://localhost:3306/upepeoproject", "root", "");
//create a connection to the database
Statement sqlStatements = sqlConnection.createStatement();

pst=sqlConnection.prepareStatement("SELECT * FROM invetory where vcode= ? ");

pst2=sqlConnection.prepareStatement("SELECT * FROM invetory where vcode= ? ");

pst2.setString(1,searchVideo.getText() );

queryResults=pst2.executeQuery();


pst.setString(1,searchVideo.getText());


queryResults=pst.executeQuery();

if(queryResults.next()){
    
    String avail=queryResults.getString("availability");
    
if(avail.equals("MISSING")){
     vcodeb.setText(null);
    vlabelb.setText(null);
    vcategoryb.setText(null);
    vCategorypaymentb.setText(null);
    
    JOptionPane.showMessageDialog(null,"It is possible that the video you are searching is : \n 1:  currently on loan \n 2:  Does'nt exist","MISSING VIDEO",JOptionPane.ERROR_MESSAGE);
    
}else{
    
    svcode=queryResults.getString("vcode");
    slabel=queryResults.getString("vlabel");
    scategory=queryResults.getString("category");
    svPAYMENT=queryResults.getString("payments");
    
    vcodeb.setText(svcode);
    vlabelb.setText(slabel);
    vcategoryb.setText(scategory);
    vCategorypaymentb.setText(svPAYMENT);
    
}
}else{
    JOptionPane.showMessageDialog(null, "That video is missing");
}
        
        }catch(SQLException e){
            JOptionPane.showMessageDialog(null, "SERVER SAYS: "+e.getMessage(),"SERVER MESSAGE",JOptionPane.ERROR_MESSAGE);
        }
    }
}

//searchMemberEvent

public class searchMemberEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
       
        try{
           sqlConnection = DriverManager.getConnection("jdbc:mysql://localhost:3306/upepeoproject", "root", "");
//create a connection to the database
Statement sqlStatements = sqlConnection.createStatement();

pst=sqlConnection.prepareStatement("SELECT * FROM membersregistrationtable where mID= ? ");

pst.setString(1,searchMember.getText());

queryResults=pst.executeQuery();

if(queryResults.next()){
    String smid=queryResults.getString("mID");
   String sfirstname=queryResults.getString("firstname");
     String smiddlename=queryResults.getString("middlename");
      String slastname=queryResults.getString("lastname");
    
    mIDb.setText(smid);
    fNameb.setText(sfirstname);
    middlenameb.setText(smiddlename);
    lNameb.setText(slastname);

}else{
    JOptionPane.showMessageDialog(null, "That video is missing");
}

        }catch(SQLException e){
            JOptionPane.showMessageDialog(null, "SERVER SAYS: "+e.getMessage(),"SERVER MESSAGE",JOptionPane.ERROR_MESSAGE);
        }
    }
}

public class saveButtonEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
       String mid,first,middle,last,vcode,vlabel,vcategory,pay,borrowdate,datedue;
     
       mid=mIDb.getText();
        first=fNameb.getText();
        middle=middlenameb.getText();
        last=lNameb.getText();
        vcode=vcodeb.getText();
        vlabel=vlabelb.getText();
        vcategory=vcategoryb.getText();
        pay=vCategorypaymentb.getText();
        borrowdate=((JTextField)BorrowersjDateChooser.getDateEditor().getUiComponent()).getText();
        datedue=((JTextField)BorrowersDueDatejDateChooser.getDateEditor().getUiComponent()).getText();
        
        if(mid.isEmpty()||first.isEmpty()||middle.isEmpty()||last.isEmpty()||vcode.isEmpty()||vlabel.isEmpty()||vcategory.isEmpty()||pay.isEmpty()||borrowdate.isEmpty()||datedue.isEmpty()){
            JOptionPane.showMessageDialog(null,"ALL FIELDS ARE MADATORY!!!","ERROR",JOptionPane.INFORMATION_MESSAGE);
        }else{
            try{
            Connection sqlConnections = DriverManager.getConnection("jdbc:mysql://localhost:3306/upepeoproject", "root", "");
//create a connection to the database
Statement sqlStatements = sqlConnections.createStatement();

String INSERT_QUERY = "INSERT INTO borrowerstable VALUES('" + vcode + "','" + vlabel + "','" + vcategory + "','"+pay+"','"+mid+"','"+first+"','"+middle+"','"+last+"','"+borrowdate+"','"+datedue+"');";
String UPDATE_QUERY="UPDATE invetory SET availability='MISSING' WHERE vcode='"+vcodeb.getText()+"'";

sqlStatements.execute(INSERT_QUERY);

sqlStatements.execute(UPDATE_QUERY);

JOptionPane.showMessageDialog(null,first+" : "+"records were saved successfully and The Catalogue Updated Accordingly","SUCCESSFUL RECORD ENTRY",JOptionPane.INFORMATION_MESSAGE);
            
        }catch(SQLException e){
            JOptionPane.showMessageDialog(null,"SERVER SAYS: "+e.getMessage(),"ERROR",JOptionPane.ERROR_MESSAGE);
        }
         
    }
    }
}
//R e   s   e   t       Bu  T   O   O   N    E  V   E   N   T   

public class resetEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
        searchMember.setText(null);
        searchVideo.setText(null);
        mIDb.setText(null);
        fNameb.setText(null);
        middlenameb.setText(null);
        lNameb.setText(null);
        vcodeb.setText(null);
        vlabelb.setText(null);
        vcategoryb.setText(null);
        vCategorypaymentb.setText(null);
        BorrowersjDateChooser.setDate(null);
        BorrowersDueDatejDateChooser.setDate(null);
    } 
}

public class cancelButtonEvent implements ActionListener{
    public void actionPerformed(ActionEvent ev){
        int i=JOptionPane.showConfirmDialog(null, "Are you sure that you want to cancel","CONFIRM",JOptionPane.YES_NO_OPTION);
        try{
            if(i==JOptionPane.YES_OPTION){
                int a=JOptionPane.showConfirmDialog(null, "Do you want to perform any other operation ?","CONFIRM",JOptionPane.YES_NO_OPTION);
                if(a==JOptionPane.YES_OPTION){
                    
                }else{
                    System.exit(0);
                }
            }
        }catch(Exception e){
            JOptionPane.showMessageDialog(null, " THE SYSTEM SAYS: "+ e.getMessage(),"ERROR",JOptionPane.ERROR_MESSAGE);
        }
        }
    }
            

//C A   T   A   L   O   G   U   E       E   V       E   N   T   S

public class aEvent implements ActionListener{
public void actionPerformed(ActionEvent ev){
String id, label, dat,vc,va,ve;
id=vid.getText();
label=vL.getText();
dat=((JTextField)CataloguejDateChooser.getDateEditor().getUiComponent()).getText();
vc=(String) vCat.getSelectedItem();
va=(String)vAvail.getSelectedItem();
    
if( id.isEmpty()||label.isEmpty()|| dat.isEmpty()||vc.isEmpty()||va.isEmpty()){
JOptionPane.showMessageDialog(null, "Error! Empty set", "Error Message", JOptionPane.ERROR_MESSAGE);
}else{
    try{
    Connection sqlConnection = DriverManager.getConnection("jdbc:mysql://localhost:3306/upepeoproject", "root", "");
//create a connection to the database
Statement sqlStatements = sqlConnection.createStatement();
String INSERT_QUERY = "INSERT INTO invetory VALUES('" + id + "','" + label+ "','" + vc + "','"+va+"','"+dat+"');";
sqlStatements.execute(INSERT_QUERY);
JOptionPane.showMessageDialog(null,"The video: "+label+" "+"was  added successfully","SUCCESSFUL VIDEO ENTRY",JOptionPane.INFORMATION_MESSAGE);


}catch(SQLException e){
        JOptionPane.showMessageDialog(null,"SERVER SAYS: "+e.getMessage(),"ERROR",JOptionPane.ERROR_MESSAGE);
        }

}
}
}
public class cEvent implements ActionListener{
public void actionPerformed(ActionEvent ev){
int c=JOptionPane.showConfirmDialog(null, "Are you sure you want to cancel ?","Confirm Message",JOptionPane.YES_NO_CANCEL_OPTION);
try{
if (c==JOptionPane.YES_OPTION){
int op=JOptionPane.showConfirmDialog(null,"Do you wish to perform other operations ?","OTHER OPERATIONS",JOptionPane.YES_NO_OPTION);
        if(op==JOptionPane.YES_OPTION){
 
            }else{
  System.exit(0);
        }
}else{

}
}catch(Exception e){
JOptionPane.showMessageDialog(null, e.getMessage());
}
}
}
public class nEvent implements ActionListener{
public void actionPerformed(ActionEvent ev){
vid.setText(null);
vAvail.setSelectedIndex(0);
vCat.setSelectedIndex(0);
vL.setText(null);
CataloguejDateChooser.setDate(null);
}
}
//E     n       d       o    f          V       i       d       e       o       C       a       t       a       l       o       g   u   e D     e       t   a       i   l   s
public static void main(String [] args){
    javax.swing.SwingUtilities.invokeLater(
    
    new Runnable(){
        @Override
        public void run(){
            Returns returns = new Returns();
        }
    }
    
    );
}
    
}
